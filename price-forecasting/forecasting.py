from pyspark import SparkContext
from pyspark.sql import SQLContext
from pyspark.sql import functions as F
from pyspark.sql.window import Window

def main():
    spark = SparkSession. \
        builder. \
        appName("price-forecasting-btc-2014-2021"). \
        getOrCreate()
    btc_usd = spark.read \
        .option("header", "true") \
        .option("inferSchema", "true") \
        .csv("BTC-USD.csv")
    btc_usd \
        .orderBy("Date") \
        .show()

    """
    +----------+----------+----------+----------+----------+----------+--------+
    |      Date|      Open|      High|       Low|     Close| Adj Close|  Volume|
    +----------+----------+----------+----------+----------+----------+--------+
    |2014-09-17|465.864014|468.174011|452.421997|457.334015|457.334015|21056800|
    |2014-09-18|456.859985|456.859985|413.104004|424.440002|424.440002|34483200|
    |2014-09-19|424.102997|427.834991|384.532013| 394.79599| 394.79599|37919700|
    |2014-09-20|394.673004| 423.29599|389.882996|408.903992|408.903992|36863600|
    |2014-09-21|408.084991|412.425995|   393.181|398.821014|398.821014|26580100|
    |2014-09-22|399.100006|406.915985|397.130005|402.152008|402.152008|24127600|
    """

    btc_usd \
        .summary("count", "min", "25%", "75%", "max") \
        .show()
    """
    +-------+----------+------------+------------+------------+------------+------------+------------+
    |summary|      Date|        Open|        High|         Low|       Close|   Adj Close|      Volume|
    +-------+----------+------------+------------+------------+------------+------------+------------+
    |  count|      2713|        2713|        2713|        2713|        2713|        2713|        2713|
    |    min|2014-09-17|  176.897003|  211.731003|  171.509995|  178.102997|  178.102997|     5914570|
    |    25%|      null|  606.396973|  609.260986|  604.109985|  606.718994|  606.718994|    79910800|
    |    75%|      null|10452.399414|10762.644531|10202.387695|10462.259766|10462.259766| 24569921549|
    |    max|2022-02-19|67549.734375|   68789.625|  66382.0625|67566.828125|67566.828125|350967941479|
    +-------+----------+------------+------------+------------+------------+------------+------------+
    """


if __name__ == "__main__":
    main()